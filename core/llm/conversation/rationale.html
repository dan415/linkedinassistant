<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://linkedin_assistant.readthedocs.io/core/llm/conversation/rationale.html" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Conversations Agent - LinkedIn Assistant</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Conversations Agent";
        var mkdocs_page_input_path = "core/llm/conversation/rationale.md";
        var mkdocs_page_url = "/core/llm/conversation/rationale.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../index.html" class="icon icon-home"> LinkedIn Assistant
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../release_notes/rationale.html">Release Notes</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Core Components</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >LLMs</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Conversations Agent</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../model_providers/rationale.html">Model Providers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../retrieval/rationale.html">Retrieval Workflow</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../pdf/rationale.html">PDF Module</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../publications/rationale.html">Publications</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Information Components</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../information/rationale.html">About</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../information/searcher/rationale.html">Content Searcher</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../information/producer/rationale.html">Publications Producer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Sources</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../information/sources/arxiv/rationale.html">Arxiv</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../information/sources/manual_pdfs/rationale.html">Manual PDF Input</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Rapid</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../information/sources/rapid/rationale.html">About</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../../information/sources/rapid/google_news/rationale.md">Google News</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../information/sources/rapid/medium/rationale.html">Medium</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../information/sources/rapid/youtube/rationale.html">YouTube</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../telegram/rationale.html">Telegram Bot</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../linkedin/rationale.html">LinkedIn</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../windows/rationale.html">Windows Service</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../main/rationale.html">Main Component</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../todo/rationale.html">Next Steps</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../LICENSE">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">LinkedIn Assistant</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Core Components</li>
          <li class="breadcrumb-item">LLMs</li>
      <li class="breadcrumb-item active">Conversations Agent</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2> Langchain Agent </h2>

<p>The Langchain agent is based on a langchain react agent for LLM models. Therefore,
the agent has access to tools.</p>
<h3> About the conversation history </h3>

<p>Each conversation thread is set to match the publication_id of one of the posts. </p>
<p>For this, we use the method <code>produce_publication</code> which receives a publication with the publication id set.
This method also adds int the system prompt and the publication. This system prompt is preserved throughout the
conversation, as the trimming method is configured to maintain the system prompt.</p>
<p>If you are familiar with the <code>MemorySaver</code> and <code>BaseCheckpointSaver</code> classes (Checkpointer classes) in
LangGraph, what we do is carry out an implementation that achieves the checkpointing but instead of executing
in memory, it does so in MongoDB.</p>
<p>Therefore, all checkpoints are saved seamlessly inside MongoDB inside <code>checkpoint_writes</code> and  <code>checkpoints</code> 
collections. This way, we can always surf through the different conversations simply defining the parameter to <code>invoke</code>:</p>
<pre><code class="language-json">{&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;whatever_publication_id&quot;}}
</code></pre>
<p><em>Note that this unrelated to what langchain defines as "long-term memory". This is basic conversation history handling, but 
with the advance of always preserving the state as long as the publication is not published to LinkedIn or discarded.
Upon the publication achieving one of these states, the conversation history is erased from database for storage optimization</em></p>
<h3> Response format </h3>
<p>LinkedIn does not allow for Markdown format, but I find that most llms are better at formatting their responses in Markdown. 
So what I do to still be able to write formatted posts is to use a formatter to bold Markdown bold strings as unicode bold characters.</p>
<h3> Multimodal input </h3>
<p>If the model admits multimodal input (text and images domains), you will be able to pass in an image apart from
the text in the messages to the agent. </p>
<h3> Langchain Agent Configuration </h3>

<p>The configuration file must be contained inside the <code>config</code> collection with the field <code>config_name</code>: <code>"llm-conversation-agent"</code>. It contains the following parameters:</p>
<ul>
<li><code>max_conversation_length</code>: The maximum length of the conversation. This is used to limit the memory of the agent at n previous messages.</li>
<li><code>system_prompt_template</code>: The system prompt template is used in conjunction with the actual post (in json format) in order to generate the content. It gives the model the required instructions</li>
<li><code>tools</code>: Can be a list combination of any prebuilt langchain agent + <code>generate_image</code>. This tool is the implemented form of generating an image and setting it as the post image. The react agent expects the find at least one tool to use, so this list cannot be empty.</li>
<li><code>model_provider</code>: The chat model provider, can be any supported chat model</li>
<li><code>image_model_provider</code>: Image model provider, as of now, only <code>dalle-openai</code> is supported</li>
<li><code>image_generation_prompt</code>: Prompt for generating the images</li>
<li><code>trimming_strategy</code>: Can be one of <code>token</code> <code>message</code>.</li>
<li><code>apply_unicode_bold</code>: If set to True, message formatting for changing bold MarkDown strings to unicode bold characters will be used</li>
<li><code>max_tokens</code>: Max tokens to pass to the model. It is used to trim the conversation history when <code>trimming_strategy</code> is set to <code>token</code></li>
<li><code>max_conversation_length</code>: Number of max allowed messages to be passed to the model. It is used to trim the conversation history when <code>trimming_strategy</code> is set to <code>message</code></li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../../release_notes/rationale.html" class="btn btn-neutral float-left" title="Release Notes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../model_providers/rationale.html" class="btn btn-neutral float-right" title="Model Providers">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../../release_notes/rationale.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../model_providers/rationale.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
